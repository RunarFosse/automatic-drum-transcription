\begin{tikzpicture}[
    very thick,
    arrow/.style={
        -latex,
        very thick,
        rounded corners=0.2cm
    },
    ]

\node[anchor=south, label=above:{Input Spectrogram}] at (0, 0){\footnotesize{($T \times D_\text{STFT}$)}};

\draw[arrow] (0, 0) -- (0, -1.5) node [rectangle,
rounded corners,
draw,
anchor=north,
fill=magenta!20,
minimum height=1cm,
minimum width=4cm
] (a) {Convolution (ReLU): $C_i$  $3 \times 3$};

\draw (a) -- (0, -2.75) node[rectangle,
rounded corners,
draw,
anchor=north,
fill=white!100,
minimum height=0.75cm,
minimum width=4cm
] (b) {Batch normalization};

\draw (b) -- (0, -3.825) node[rectangle,
rounded corners,
draw,
anchor=north,
fill=white!100,
minimum height=0.75cm,
minimum width=4cm
] (c) {Max pooling: $1 \times 3$};

\draw (c) -- (0, -4.825) node[rectangle,
rounded corners,
draw,
anchor=north,
fill=white!100,
minimum height=0.75cm,
minimum width=4cm
] (d) {Dropout: $p = 0.3$};

\coordinate (a1) at ($(a.north west) + (-0.85, 0.125)$);
\coordinate (d1) at ($(a.north east |- d.south east) + (0.125, -0.075)$);

\begin{scope}[on background layer]
    \node[rectangle,
    fill=gray!10,
    rounded corners=3mm,
    label=west:$2\times$,
    draw,
    very thick,
    fit= (a1) (d1)] {};
    
    \node[rectangle,
    fill=gray!20,
    rounded corners=3mm,
    label=west:$2\times$,
    draw,
    very thick,
    fit=(a) (b)] {};
\end{scope}


\draw[arrow] (d) -- (0, -7) node[rectangle, 
rounded corners, 
draw, 
anchor=north, 
label=west:$L\times$,
fill=cyan!20,
minimum height=1cm,
minimum width=4cm
] (g) {Fully connected: $H$};

\draw[arrow] (g) -- (0, -8.5) node[rectangle, 
rounded corners, 
draw, 
anchor=north, 
fill=blue!20,
minimum height=1cm,
minimum width=4cm
] (h) {Linear (Sigmoid): $5$};

\draw[arrow] (h) -- (0, -11.5);

\node[anchor=north, label=below:{Output Probabilities}] at (0, -11.5){\footnotesize{($T \times 5$)}};

\end{tikzpicture}